===============================================================================
BORROWINGPROCESS FOLDER - HOÀN CHỈNH THEO CLASS DIAGRAM VÀ ĐẶC TẢ
===============================================================================
Ngày cập nhật: 18/11/2025
Trạng thái: ✅ HOÀN THÀNH 100%

===============================================================================
I. CẤU TRÚC FOLDER
===============================================================================

BorrowingProcess/
├── Models/
│   └── Order.h/cpp          # Model Order duy nhất theo Class Diagram
└── Services/
    └── BorrowService.h/cpp  # Service quản lý Order

ĐÃ XÓA (không có trong class diagram):
❌ BorrowRecord.h/cpp - Đã xóa, thay bằng Order
❌ Reservation class riêng - Đã merge vào Order với status RESERVED
❌ History class - Không cần thiết, dùng getAllOrders()

===============================================================================
II. ORDER MODEL - THEO CLASS DIAGRAM
===============================================================================

✅ Attributes (đầy đủ):
   - orderId: string          # Mã đơn mượn duy nhất (ORD-xxx)
   - userId: string           # Mã người mượn
   - bookId: string           # Mã sách
   - status: string           # PENDING/ISSUED/RETURNED/OVERDUE/RESERVED/CANCELLED
   - rating: int              # Đánh giá 1-5 sao
   - review: string           # Nhận xét
   - borrowDate: string       # Ngày đăng ký mượn
   - issueDate: string        # Ngày cho mượn thực tế
   - dueDate: string          # Ngày hạn trả
   - returnDate: string       # Ngày trả thực tế
   - renewalPeriod: int       # Số lần gia hạn
   - bookCondition: string    # GOOD/DAMAGED/LOST (theo functional requirements)

✅ Methods (theo class diagram):
   - createOrder()            # Tạo đơn mượn mới
   - updateStatus(newStatus)  # Cập nhật trạng thái
   - addReview(rating, text)  # Thêm đánh giá
   - renewOrder()             # Gia hạn đơn mượn
   
✅ Helper Methods:
   - displayOrderInfo()       # Hiển thị thông tin đơn
   - isOverdue()              # Kiểm tra quá hạn

===============================================================================
III. BORROWSERVICE - THEO FUNCTIONAL REQUIREMENTS
===============================================================================

✅ Core Borrowing Operations:
   borrowBook(userId, bookId, borrowDate, dueDate)
   └─> Tạo Order với status ISSUED
   └─> Cập nhật book status thành BORROWED
   └─> Ghi nhận borrower, dates theo đặc tả
   
   returnBook(orderId, returnDate, bookCondition)
   └─> Cập nhật Order: returnDate, bookCondition, status=RETURNED
   └─> Cập nhật book status về AVAILABLE (nếu GOOD)
   └─> Cập nhật book condition (nếu DAMAGED/LOST)
   
   renewOrder(orderId)
   └─> Tăng renewalPeriod
   └─> Cập nhật dueDate (extend borrowing period)

✅ Reservation Operations:
   reserveBook(userId, bookId, reservationDate)
   └─> Tạo Order với status RESERVED
   
   cancelReservation(orderId, userId)
   └─> Cập nhật Order status thành CANCELLED
   
   getReservationsByUser(userId)
   └─> Trả về danh sách Order với status RESERVED

✅ Review Operations:
   addReviewToOrder(orderId, rating, review)
   └─> Gọi Order::addReview()
   └─> Chỉ cho phép review Order đã RETURNED

✅ History & Queries:
   getBorrowHistory(userId)
   └─> Trả về tất cả Order của user
   
   getActiveOrders(userId)
   └─> Trả về Order có status ISSUED
   
   getOverdueOrders()
   └─> Trả về Order quá hạn
   
   getAllOrders()
   └─> Trả về tất cả Order trong hệ thống

===============================================================================
IV. TUÂN THỦ FUNCTIONAL REQUIREMENTS
===============================================================================

✅ "The system records details about the borrower, borrowing date, return 
    date, and the book's condition"
    → Order có: userId, borrowDate, returnDate, bookCondition

✅ "Readers can confirm the return of a book or extend the borrowing period"
    → returnBook() và renewOrder()

✅ "Track borrower, borrowing date, return date, and the book's condition"
    → Order model có đầy đủ các thông tin này

✅ "Reserve books that are currently borrowed"
    → reserveBook() tạo Order với status RESERVED

✅ "Cancel their reservations"
    → cancelReservation()

✅ "View borrow history"
    → getBorrowHistory()

✅ "Add review and rating"
    → addReviewToOrder()

===============================================================================
V. KHÁC BIỆT SO VỚI THIẾT KẾ CŨ
===============================================================================

TRƯỚC:
- BorrowRecord class riêng
- Reservation class riêng  
- History class riêng
→ 3 models khác nhau, phức tạp

SAU (THEO CLASS DIAGRAM):
- Chỉ có Order class duy nhất
- Dùng status để phân biệt: ISSUED, RESERVED, RETURNED, etc.
→ Đơn giản, dễ quản lý, đúng Class Diagram

===============================================================================
VI. INTEGRATION VỚI CÁC MODULE KHÁC
===============================================================================

✅ BookService:
   - Order lưu bookId
   - BorrowService cập nhật book status khi borrow/return
   - BorrowService cập nhật book condition khi return

✅ UserService:
   - Order lưu userId
   - Dùng userId để query lịch sử

✅ AdminService & ReportGenerator:
   - getAllOrders() cung cấp dữ liệu cho báo cáo
   - generateBorrowReport() dùng Order
   - generateOverdueReport() dùng getOverdueOrders()

✅ Main.cpp:
   - Member menu: getBorrowHistory(), reserveBook(), renewOrder()
   - Librarian menu: borrowBook(), returnBook()
   - Sử dụng Order.getOrderId(), getStatus(), etc.

===============================================================================
VII. STATUS VALUES
===============================================================================

Order có thể có các status sau:
- PENDING      # Đơn đang chờ xử lý (ít dùng)
- ISSUED       # Đã cho mượn (đang mượn)
- RETURNED     # Đã trả
- OVERDUE      # Quá hạn
- RESERVED     # Đặt trước
- CANCELLED    # Đã hủy

===============================================================================
VIII. COMPILATION STATUS
===============================================================================

✅ Successfully compiled
✅ No errors, no warnings
✅ All methods integrated correctly
✅ Backward compatibility maintained

Files compiled:
- BorrowingProcess/Models/Order.cpp
- BorrowingProcess/Services/BorrowService.cpp

===============================================================================
IX. KẾT LUẬN
===============================================================================

Folder BorrowingProcess đã được cập nhật hoàn toàn theo:
✅ Class Diagram (chỉ có Order class)
✅ Functional Requirements (đầy đủ chức năng mượn/trả/gia hạn/đặt trước)
✅ Clean Architecture (đơn giản, rõ ràng, dễ bảo trì)

Order model là trung tâm của quá trình mượn/trả sách, thay thế cho 
BorrowRecord, Reservation và History cũ, giúp code đơn giản và dễ hiểu hơn.

===============================================================================
END OF REPORT
===============================================================================
